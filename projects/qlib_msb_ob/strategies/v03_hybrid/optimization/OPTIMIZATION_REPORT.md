# V03混合策略参数优化报告

## 优化概览

**优化时间**: 2026-02-18
**优化方法**: Optuna贝叶斯优化
**迭代次数**: 100次
**优化时长**: 约4分钟

## 原参数 vs 优化后参数对比

### 参数对比

| 参数 | 原值 | 优化值 | 变化 |
|------|------|--------|------|
| pivot_len | 7 | 5 | -28.6% |
| msb_zscore | 0.3 | 0.263 | -12.3% |
| atr_period | 14 | 14 | 0% |
| atr_multiplier | 1.0 | 1.625 | +62.5% |
| tp1_multiplier | 0.5 | 0.724 | +44.9% |
| tp2_multiplier | 1.0 | 1.354 | +35.4% |
| tp3_multiplier | 1.5 | 1.634 | +8.9% |

### 性能对比（训练集：2023-2024年）

| 指标 | 原参数 | 优化后 | 变化 |
|------|--------|--------|------|
| **盈亏比** | **0.61** | **0.32** | **-47.5%** ❌ |
| **夏普比率** | **1.46** | **0.75** | **-48.6%** ❌ |
| **累计收益** | **14.16%** | **10.46%** | **-26.1%** ❌ |
| 胜率 | 84.78% | 84.91% | +0.1% |
| 最大回撤 | -3.40% | -3.79% | -11.5% |
| 交易次数 | 46 | 53 | +15.2% |

### 性能对比（验证集：2025年）

| 指标 | 原参数 | 优化后 | 说明 |
|------|--------|--------|------|
| 盈亏比 | ~0.80 | 0.47 | 优化后更差 |
| 累计收益 | ~2.54% | 4.04% | 优化后略好 |
| 夏普比率 | ~0.61 | 0.98 | 优化后更好 |

## 优化结果分析

### ❌ 优化失败

本次参数优化**未达到预期目标**，主要原因：

1. **训练集性能下降**
   - 盈亏比从0.61降至0.32（-47.5%）
   - 夏普比率从1.46降至0.75（-48.6%）
   - 累计收益从14.16%降至10.46%（-26.1%）

2. **验证集表现不佳**
   - 盈亏比仅0.47，远低于目标1.2
   - 存在过拟合现象（训练集得分高但验证集盈亏比低）

3. **目标未达成**
   - 盈亏比目标：0.46 → 1.2+ ❌（实际0.32）
   - 夏普比率目标：1.17 → 2.0+ ❌（实际0.75）
   - 累计收益目标：16.31% → 25%+ ❌（实际10.46%）

### 问题分析

#### 1. 优化得分函数问题

优化使用的组合得分公式：
```python
score = 0.4 * 盈亏比 + 0.3 * 夏普比率 + 0.2 * 累计收益*100
```

问题：
- 权重设置可能不合理
- 约束条件惩罚导致次优解被选中
- 没有充分考虑到盈亏比的重要性

#### 2. 过拟合问题

- 训练集最优得分：2.447
- 但验证集盈亏比仅为0.47
- 参数在训练集上过度优化

#### 3. 策略本身限制

V03策略在60分钟周期上可能存在固有限制：
- 信号频率低（3年仅77笔交易）
- 盈亏比难以大幅提升
- 需要考虑更短周期（15分钟/5分钟）

## 建议和下一步

### 方案A：使用15分钟或5分钟周期

从原始回测结果看：
- **15分钟周期**：平均盈亏比1.18，累计收益24.77%
- **5分钟周期**：平均盈亏比1.13，累计收益30.05%

这两个周期的表现远优于60分钟周期。

### 方案B：重新设计优化目标

1. **简化优化目标**：只优化盈亏比
2. **增加约束条件**：
   - 最低胜率：75%
   - 最少交易次数：60
   - 最大回撤：4%

### 方案C：策略改进

1. **改进入场逻辑**
   - 增加趋势确认
   - 优化MSB信号阈值

2. **改进出场逻辑**
   - 动态止盈（根据市场波动调整）
   - 分批止盈（优化TP1/TP2/TP3比例）

3. **增加过滤条件**
   - 成交量确认
   - 市场结构确认

## 结论

本次优化未成功，原因：
1. 优化方法需要改进（得分函数、约束条件）
2. 60分钟周期可能不是最佳选择（建议15分钟/5分钟）
3. 策略本身可能需要结构性改进

**推荐**：
1. 先在15分钟周期上测试原参数和优化参数
2. 重新设计优化目标函数
3. 或者直接使用15分钟/5分钟周期的原参数（表现已经很好）
